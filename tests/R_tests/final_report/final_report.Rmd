---
title: Novel Generation of Purely Synthetic Educational Dataset Effective For Research Applications
authors:
  - name: Austin Nicolas
    thanks: The author's previous work that generated the dataset analyzed in this work can be found here https://github.com/austineamonn/SummerResearch2024
    department: Department of Biology
    affiliation: Grinnell College
    location: Grinnell, IA 50122
    email: nicolasa@grinnell.edu
abstract: |
  The research applications of currently available education datasets are limited by ethical concerns due to privacy loss revealing sensitive information about the students in the datasets. Current educational research uses machine learning to augment and analyze the currently available datasets. In parallel, in silico research is developing purely synthetic datasets generated based on empirical datasets. When carefully handled, these datasets can effectively limits privacy loss concerns. A purely synthetic dataset was developed for use in educational research by sampling from known distributions and creating novel mappings (Nicolas & Sakib, 2024). However, no testing was done to compare the dataset to the original sampling distributions. This work examines the dataset to see if data generation aligned with sampling distributions and if weighted mappings effectively correlated features. We found that the generative function mostly sampled and mapped effectively to create significant correlations and distributions. Thus, the purely synthetic dataset mostly matches empirical data when such correlations and distributions were encoded in the generation function and the dataset, with some changes, can be used for educational research cases without privacy loss.
keywords:
  - synthetic data generation
  - educational research
bibliography: references.bib
csl: apa.csl
output:
  bookdown::pdf_book:
    base_format: rticles::arxiv_article
    extra_dependencies: ["tabularx", "amsmath", "multirow"]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE,
                      out.width = "90%", fig.align = "center")

if (!require(tidyverse)) install.packages('tidyverse', dependencies = TRUE) 
suppressWarnings(suppressMessages(library(tidyverse)))

if (!require(jsonlite)) install.packages('jsonlite', dependencies = TRUE) 
suppressWarnings(suppressMessages(library(jsonlite)))

if (!require(Dict)) install.packages('Dict', dependencies = TRUE) 
suppressWarnings(suppressMessages(library(Dict)))

if (!require(RColorBrewer)) install.packages('RColorBrewer', dependencies = TRUE)
suppressWarnings(suppressMessages(library(RColorBrewer)))

if (!require(viridis)) install.packages('viridis', dependencies = TRUE) 
suppressWarnings(suppressMessages(library(viridis)))

if (!require(hrbrthemes)) install.packages('hrbrthemes', dependencies = TRUE) 
suppressWarnings(suppressMessages(library(hrbrthemes)))

```

# Introduction

In the past 20 years, educational research has begun using machine learning and artificial intelligence for a wide variety of purposes. The most common uses are for computer assisted instruction, virtual reality, tutoring systems, and augmented reality, which combined make up over 70% of recent educational research in artificial intelligence and machine learning [@guan2020]. However some educators warn that data driven approaches cannot replace educator experience and intuition, raising concerns about overreliance on artificial intelligence and machine learning outputs for determining educational policy and practices [@mandinach2021]. These works almost always use empirical data which can leak private information about students despite data privatization practices.

Synthetic datasets have been uplifted as an alternative to empirical data for data augmentation purposes and to limit privacy loss. However, synthetic datasets are not automatically private, with privacy leakage risks of the data used to generate the synthetic dataset [@jordon2022]. Thus, purely synthetic datasets are not based on specific empirical datasets have arisen as a solution to privacy loss concerns. Recent in silico work has used purely synthetic data in a wide variety of ways, including improving machine learning algorithm training speed [@gonsior2021], restoring resolution to degraded low resolution images [@wang2021], and annotating medical images [@liu2024].

One recent study used machine learning to predict future courses that university students would be interested in based on previous classes taken [@shao2021]. More recently, a similar study was conducted that used a purely synthetic dataset based on known distributions and novel feature mappings rather than real world data that could be traced back to real students [@nicolas2024]. Nicolas and Sakib developed a novel technique to generate the purely synthetic educational dataset for educational research purposes. Nicolas and Sakib focused on the privacy loss implications under several data privatization methods rather than the accuracy of the purely synthetic dataset. This work takes the dataset and examines if the generating function worked as the authors had intended.

We hypothesize that the data generation function from @nicolas2024 functioned as intended. To support this hypothesis, we test whether observed feature distribution fits the sampled empirical distributions and whether features are correlated with eachother. Our first prediction is that dataset feature distributions will match the empirical sampling distribution. Next, we predict that the explicitly mapped features will be correlated. We also predict that the converse of the second prediction will be true. In other words, all features that were not explicitly mapped together will not be correlated.

\begin{table}[htbp]
  \centering
  \begin{tabular}{|l|l|}
    \hline
    Hypothesis & The data generation function worked as intended. \\ \hline
    Prediction 1 & Dataset feature distributions will match the empirical sampling distribution. \\ \hline
    Prediction 2 & Explicitly mapped features will be correlated. \\ \hline
    Converse of Prediction 2 & Non explicitly mapped features will not be correlated. \\ \hline
  \end{tabular}
  \caption{Hypothesis and Predictions.}
  \label{tab:hypothesis_predictions}
\end{table}

# Methods

First, initial data preparation was done on the two datasets and then functions were developed to streamline the analysis process. Finally, Demographics, Majors, and Learning Styles were analyzed to see if the observed distribution matched the expected distribution and if features were correlated with one another. Here is a quick outline of this section:

1.  Datasets (\ref{sec:datasets})
2.  Data Preparation (\ref{sec:data_preparation})
3.  Demographics (\ref{sec:demographics})
4.  Major (\ref{sec:major})
5.  Learning Style (\ref{sec:learning_style})
6.  Complex Correlations (\ref{sec:complex_correlations})

Before we explain the methodology of the paper we quickly overview the datasets involved in the work.

## Datasets

\label{sec:datasets}

There were two datasets used in this analysis, both of which were generated in a paper by @nicolas2024. The *Purely Synthetic Education Dataset* was created by a novel generating function while the *Majors Dataset* was created by webscrapping data from @zotero-106.

### Purely Synthetic Education Dataset

The *Purely Synthetic Education Dataset* was generated by sampling from known distributions or randomly selecting when distributions were unknown. Additionally, novel mappings were built between different columns to reflect known connections [@nicolas2024]. The flowchart (Figure ref{fig:data_generation}) shows the process used for generating each observation in the dataset.

(ref:nicolas2024) This data generation flowchart was taken from [@nicolas2024].

```{r nicolas2024, echo=FALSE, fig.cap="(ref:nicolas2024)\\label{fig:data_generation}"}

knitr::include_graphics("data_generation_flowchart.png")

```

Table \ref{tab:features_table} from @nicolas2024 showcases the different features of the dataset. In this work, **Ethnoracial Group**, **Gender**, **International Student Status**, **Socioeconomic Status**, **GPA**, **Learning Style(s)**, **Student Semester**, **Major(s)**, **Previous Course Types**, and **Previous Course Subjects**, were analyzed.

\begin{table}[htbp]
    \centering
    \begin{tabular}{|l|l|l|l|}
        \hline
        \textbf{Features} & \textbf{Data Category} & \textbf{Data Type} & \textbf{Number of Options}\\ \hline
        First Name & $X_p$ & String & 32,952 \\ \hline
        Last Name & $X_p$ & String & 151,671 \\ \hline
        Ethnoracial Group & $X_p$ & String & 7 \\ \hline
        Gender & $X_p$ & String & 3 \\ \hline
        International Student Status & $X_p$ & String & 2 \\ \hline
        Socioeconomic Status & $X_p$ & String & 5 \\ \hline
        GPA & X & Double & 201 \\ \hline
        Learning Style(s) & X & List of Strings & 4 \\ \hline
        Student Semester & X & Integer & 15 \\ \hline
        Major(s) & X & List of Strings & 173 \\ \hline
        Previous Course Titles & X & List of Strings & 3,476 \\ \hline
        Previous Course Types & X & List of Strings & 21 \\ \hline
        Previous Course Subjects & X & List of Strings & 236 \\ \hline
        Subjects of Interest & X & List of Strings & 141 \\ \hline
        Extracurricular Activities & X & List of Strings & 304 \\ \hline
        Career Aspirations & $X_u$ & List of Strings & 149 \\ \hline
        Future Topics & $X_u$ & List of Strings & 226 \\ \hline
    \end{tabular}
    \caption{Information about Data Features.}
    \label{tab:features_table}
\end{table}

Table \ref{tab:first_row_transposed} shows the first row of the dataset. The row was transposed and the long string list columns were concatenated to prevent the row from running of the page.

\begin{table}[htbp]
  \centering
  \begin{tabular}{|l|l|}
    \hline
    \textbf{Column Name} & \textbf{First Entry} \\ \hline
    First name & Raycen \\ \hline
    Last Name & Tallini \\ \hline
    Ethnoracial Group & European American or white \\ \hline
    Gender & Female \\ \hline
    International Student Status & International \\ \hline
    Socioeconomic Status & Middle Income \\ \hline
    Learning Style & {[}'Read/Write'{]} \\ \hline
    GPA & 3.86 \\ \hline
    Student Semester & 10 \\ \hline
    Major & {[}'Teacher Education: Multiple Levels'{]} \\ \hline
    \multirow{2}{*}{Previous Courses} & {[}'Intensive Elementary Spanish', 'General Chemistry Lab II', \\
    & \ldots, 'Advanced Study Abroad'{]} \\ \hline
    \multirow{2}{*}{Course Types} & {[}{[}'Laboratory-Discussion', 'Lecture', 'Practice'{]}, \\
    & {[}'Lecture-Discussion', 'Online'{]},\ldots, {[}'Discussion/Recitation', 'Lecture'{]}{]} \\ \hline
    Course Subjects & {[}'ACES', 'EPOL', 'GWS',\ldots, 'ART'{]} \\ \hline
    Subjects of Interest & {[}'History', 'Philosophy',\ldots, 'Engineering'{]} \\ \hline
    \multirow{2}{*}{Extracurricular Activities} & {[}'Education Society', 'Engineering Society', \\
    & \ldots, 'Electrical Engineering Club'{]} \\ \hline
    \multirow{2}{*}{Career Aspirations} & {[}'Postsecondary Teacher', 'Other Teacher and Instructor', \\
    & \ldots, 'Material Engineer'{]} \\ \hline
  \multirow{2}{*}{Future Topics} & {[}'Leadership Studies', 'Sociology', \\
  & \ldots, 'Human Development and Family Studies'{]} \\ \hline
  \end{tabular}
  \caption{The first row of the dataset, transposed. Long list features concatenated.}
  \label{tab:first_row_transposed}
\end{table}

### Majors Dataset

The Majors Dataset was stored as a JSON file so it was imported using the JSONlite package [@ooms2024]. Table \ref{tab:majors_dataset} shows the features of the *Majors Dataset* from @nicolas2024, who based it on a data webscrapped from @zotero-106.

\begin{table}[htbp]
  \centering
  \begin{tabular}{|l|l|l|}
    \hline
    Data Column & Data Type & Data From \\
    \hline
    Major & String & Majors List \\
    \hline
    National Percent Female & float & Represents a percentage so between 0 and 1 \\
    \hline
    Popularity Ranking & Integer & Between 1 and 173 \\
    \hline
    Division & Factor & One of 6 Divisions\\
    \hline
    Top 5 Careers & List of Strings & Careers List\\
    \hline
  \end{tabular}
  \caption{Majors Dataset}
  \label{tab:majors_dataset}
\end{table}

The *Majors Dataset* contains the following major divisions: Business, Education, Health, Liberal Arts, Social Sciences, and STEM.

## Data Preparation

\label{sec:data_preparation}

The preprocessing pipelines for the features analyzed in this work are summarized in Table \ref{tab:data_prep_table}.

\begin{table}[htbp]
    \centering
    \begin{tabular}{|l|l|l|l|}
        \hline
        \textbf{Features} & \textbf{Rename Column} & \textbf{Convert to a Factor} & \textbf{Split Lists and Recombine}\\ \hline
        Ethnoracial Group & YES & YES & NO \\ \hline
        Gender & YES & YES & NO \\ \hline
        International Student Status & YES & YES & NO \\ \hline
        Socioeconomic Status & YES & YES & NO \\ \hline
        GPA & YES & NO & NO \\ \hline
        Learning Style(s) & YES & NO & YES \\ \hline
        Student Semester & YES & NO & NO \\ \hline
        Major(s) & YES & NO & YES \\ \hline
        Previous Course Types & YES & NO & YES \\ \hline
        Previous Course Subjects & YES & NO & YES \\ \hline
    \end{tabular}
    \caption{Data Preparation Pipeline.}
    \label{tab:data_prep_table}
\end{table}

Renaming columns and converting to factors was done through Tidyverse [@wickham2023]. Since the lists of strings in the *Purely Synthetic Education Dataset* were stored as strings, they had to be stripped and split into multiple columns. This was done for **Learning Styles(s)**, **Major(s)**, **Previous Course Types**, and **Previous Course Subjects** but the same process could be applied to the other list of string features. Then each split column was put into its own copy of the *Purely Synthetic Education Dataset* and they were recombined rowwise.

### Dictionary

The Dict package [@asai2020] was used to create a dictionary with feature names as the keys and the column name for the feature as the values. The key and value for **Ethnoracial Group** are shown below:

> Key: "Ethnoracial Group", Value: "ethnoracial_group"

## Demographics

\label{sec:demographics}

The demographic section looks at the following 6 features:

1.  Ethnoracial Group
2.  Gender
3.  International Student Status
4.  Socioeconomic Status
5.  GPA
6.  Student Semester

The string demographics (**Ethnoracial Group**, **Gender**, **International Student Status**, and **Socioeconomic Status**) were sampled based on empirical data distributions. The numerical demographics (**GPA** and **Student Semester**) were sampled from a uniform distribution. All the demographics were sampled independently of one another [@nicolas2024].

### Statistical Testing

The Chi Squared Goodness of Fit Test was run on **Ethnoracial Group**, **Gender**, **International Student Status**, and **Socioeconomic Status** comparing them with their known distributions. Known distributions were taken from @nicolas2024.

The Chi Squared Test of Independence was run between **Ethnoracial Group**, **Gender**, **International Student Status**, and **Socioeconomic Status**.

### Graphing

For each combination of **Ethnoracial Group**, **Gender**, **International Student Status**, and **Socioeconomic Status** a bar chart comparing the proportion of one feature across the options for the other feature was created using ggplot2 [@wickham2023] and RColorBrewer [@neuwirth2022].

For **GPA** and **Student Semester** the number of students in a given semester or with a certain GPA were graphed with a horizontal line representing the expected uniform distribution of the features. This was done using ggplot2 [@wickham2023].

## Major

\label{sec:major}

The major function from @nicolas2024 determined a student's major based on a weighting by gender and major popularity. For a major $m$, let $P_m$ be the popularity ranking of the major and let $F_m$ be the percentage of female identifying students in the major. Since there are 173 majors we know that $P_m\in[1,173]\cap\mathbb{N}$.

$$
W_m=1-\frac{P_m}{173}+\begin{cases} 
  1-\frac{F_m}{100} & \text{if student identifies as Male} \\
  \frac{F_m}{100} & \text{otherwise}
\end{cases}
$$

### Joining the Majors Dataset

A left join was used to combine the *Majors Dataset* with the *Purely Synthetic Education Dataset* where the **Major(s)** feature was split and recombined.

### Statistical Testing

The Chi Squared Goodness of Fit Test was run on the popularity of each major vs the expected popularity ranking. The observed popularity was calculated by taking the number of students in each major (splitting double majors) and ranking them. The results were graphed in a bar graph using ggplot2 [@wickham2023] and viridis [@garnier2024].

The Chi Squared Test of Independence was run with **Majors(s)** against **Ethnoracial Group**, **Gender**, **International Student Status**, and **Socioeconomic Status**.

### Gender By Major

Since **Gender** was the only feature that was explicitly called in the generating function for picking **Major(s)** then the Chi Squared Goodness of Fit test was run to compare the expected percent female of each major from the *Majors Dataset* vs what was observed in the *Purely Synthetic Education Dataset*. Then the dataset was filtered using @wickham2023 to get the top ten majors with the highest percentage of male, female, and gender minority (female and nonbinary) students. Nonbinary students were never filtered alone since the sample size was too small. Then the results were graphed in a bar graph using ggplot2 [@wickham2023] and RColorBrewer [@neuwirth2022].

## Learning Style

\label{sec:learning_style}

The learning style function from @nicolas2024 determined a student's learning style(s) based on randomly sampling from a weighted distribution based on the empirical distribution of the learning styles. There is also a 10% chance of a student getting a second learning style, though if it is a duplicate it is ignored.

### Statistical Testing

The Chi Squared Goodness of Fit Test was run on the popularity of each learning style vs the expected distribution.

The Chi Squared Test of Independence was run with **Learning Style(s)** against **Ethnoracial Group**, **Gender**, **International Student Status**, and **Socioeconomic Status**.

## Complex Correlations

\label{sec:complex_correlations}

The `pick_classes` function from @nicolas2024 determined a student's classes based on a list of classes with each class weighted as follows:

\begin{table}[htbp]
  \centering
  \begin{tabular}{|l|l|}
    \hline
    \textbf{Class matches Student's} & \textbf{Weighting} \\ \hline
    Learning Style(s) & 2 \\ \hline
    Major(s) & 5 \\ \hline
    Nothing & 1 \\ \hline
  \end{tabular}
  \caption{Class Weightings.}
  \label{tab:class_weightings}
\end{table}

Classes are based on a student's **Majors(s)** and **Learning Style(s)**. So, a student with a math major would be more likely to take a math course. From each class the course subject was taken (ex: MAT for a math class). Additionally, a student with a Read/Write learning style would be more likely to take courses that focus on reading and writing. From each class the course type was taken (ex: Lecture for a math class), with each course type being associated with one or more learning styles. Thus, we want to determine if there are correlations between these variables.

Take the joined dataset that was already split by **Major(s)** and split it by **Course Subjects**. Then recombine using the `rbind` function from base R. Then the Chi Squared Test Test of Independence is run to determine if **Major(s)** and **Course Subjects** are correlated.

Take the dataset that was already split by **Learning Style(s)** and split it by **Course Types**. Then recombine using the `rbind` function from base R. Then the Chi Squared Test Test of Independence is run to determine if **Learning Style(s)** and **Course Types** are correlated.

# Results

1.  Demographics (\ref{sec:demographics_res})
2.  Major (\ref{sec:major_res})
3.  Learning Style (\ref{sec:learning_style_res})
4.  Complex Correlations (\ref{sec:complex_correlations_res})

```{r initial_work, echo=FALSE, results=FALSE}
# Hide the code and the output. The following code is slightlyaltered from the Final Project Code to remove unnecessary functionality. For example Chi Squared values are reported in tables, so there is no need to calculate them in this document. The code here is solely to reproduce the graphs, though unlike in the HMTL document, they are not interactive since this paper is knitted to pdf.

# Import the dataset
dataset <- read_csv("Dataset.csv")

# Rename the dataset columns and convert some to factors
dataset <- dataset |>
  rename(first_name = `first name`) |>
  rename(last_name = `last name`) |>
  rename(ethnoracial_group = `ethnoracial group`) |>
  mutate(ethnoracial_group = as.factor(ethnoracial_group)) |>
  mutate(gender = as.factor(gender)) |>
  rename(international_status = `international status`) |>
  mutate(international_status = as.factor(international_status)) |>
  rename(socioeconomic_status = `socioeconomic status`) |>
  mutate(socioeconomic_status = as.factor(socioeconomic_status)) |>
  rename(learning_style = `learning style`) |>
  rename(student_semester = `student semester`) |>
  rename(previous_courses = `previous courses`) |>
  rename(course_types = `course types`) |>
  rename(course_subjects = `course subjects`) |>
  rename(subjects_of_interest = `subjects of interest`) |>
  rename(extracurricular_activities = `extracurricular activities`) |>
  rename(career_aspirations = `career aspirations`) |>
  rename(future_topics = `future topics`)

# Create a dictionary of column names. Only do columns that have correlation graphs
dataset_col_names <- dict(
    "Ethnoracial Group" = "ethnoracial_group",
    "Gender" = "gender",
    "International Student Status" = "international_status",
    "Socioeconomic Status" = "socioeconomic_status"
    )

# This function makes correlation graphs
correlation_graph <- function(x_name, y_name, flip = TRUE) {
  # Get the x and y columns based on the inputed name
  .x = dataset_col_names[x_name]
  .y = dataset_col_names[y_name]
    
  # Make the ggplot
  plot <- ggplot(dataset, aes_string(x = .x,
                    fill = .y)) +
  geom_bar(position = "fill") +
  theme_classic() +
  scale_fill_brewer(palette = "Dark2") +
  labs(x = x_name,
       y = "Proportion",
       fill = y_name)
  
  # Flip coordinates if flip is TRUE
  if (flip) {
    plot <- plot + coord_flip()
  }
  
  # Return the plot
  return(plot)
}

# This function splits the list columns
split_into_multiple <- function(column, into_prefix, pattern = "\', \'"){
  cols <- str_split_fixed(column, pattern, n = Inf)
  # Sub out the ""'s returned by filling the matrix to the right, with NAs which are useful
  cols[which(cols == "")] <- NA
  cols <- as.tibble(cols)

  # name the 'cols' tibble as 'into_prefix_1', 'into_prefix_2', ..., 'into_prefix_m' 
  # where m = # columns of 'cols'
  m <- dim(cols)[2]

  names(cols) <- paste(into_prefix, 1:m, sep = "_")
  
  # Convert the tibble to a dataframe
  cols <- as.data.frame(cols)
  
  # Remove remaining brackets and quotes
  for (i in 1:m) {
    cols[,i] <- str_remove_all(cols[,i], "[\'\\[\\]]")
  }
  
  return(cols)
}

# Convert split list columns into a single dataframe with demographic information
make_demographic_dataframe <- function(main_df, .columns, .name, dem_cols = c(3:6), rm.na = FALSE, .name_list = list()) {
  # Create an empty dataframe
  final_df = data.frame(ethnoracial_group=factor(),
                        gender = factor(),
                        international_status = factor(),
                        socioeconomic_status = factor())
  
  # Take each split list column and combine row wise
  for (i in .columns) {
    df <- main_df |>
      select(c(dem_cols,i))
    final_df <- rbind(final_df, setNames(df, colnames(final_df)))
  }
  

  # Add in extra names if more columns are added beyond the demographic ones
  
  if (length(.name_list) > 0) {
    for (i in 1:length(.name_list)) {
      colnames(final_df)[i+4] <- .name_list[i]
    }
  }
  
  # Ensure proper naming for the final column
  colnames(final_df)[5+length(.name_list)] <- .name
  
  # Drop the empty columns
  if (rm.na) {
    final_df <- final_df |>
      drop_na()
  }
  
  return(final_df)
}

# Makes Graphs for the different numerical columns whose data
# was generated from a uniform distribution
numerical_col_graph <- function(.dataset, .column, .name, .size) {
  
  # Get the dataset size
  row_len_df <- .dataset |>
    drop_na({{.column}})
  
  row_len <- nrow(row_len_df)

  # Make the ggplot graph with a line for the uniform distribution
  graph <- .dataset |>
    
    # Make the ggplot
    ggplot(aes(x = {{.column}})) +
    geom_bar(fill = "gray") +
    theme_ipsum(base_family = "sans") +
    labs(x = .name, y = "Number of Students") +
    geom_hline(yintercept = row_len/.size) +
    theme(legend.position="none",
          axis.title.x = element_text(hjust=0.5), 
          axis.title.y = element_text(hjust=0.5)
          )
  
  return(graph)
}

# Generate a graph of the top ten majors with the highest majority of a certain
# gender identity
major_gender_dominated_graph <- function(.dataset, .gender, .xlab, .ylab) {
  # Arrange major by top percent gender minority
  g_dominate_dataset <- .dataset |>
    arrange(desc({{.gender}}))
  
  # Get a graph of the top ten majors
  ggplot(g_dominate_dataset[1:10,],
         aes(x=reorder(major, {{.gender}}, FUN = function(x) sum(x)),
             y={{.gender}},
             fill = division)) +
    geom_bar(stat = "identity") +
    coord_flip() +
    theme_classic() +
    scale_color_brewer(palette = "Dark2") +
    labs(x = .xlab,
         y = .ylab,
         fill = "Major Division")

}

# Split the dataset by learning style, major, previous course types, and previous course subjects
dataset_split <- dataset |>
  # Learning Style
  cbind(split_into_multiple(dataset$learning_style, "learning_style")) |>
  mutate(learning_style = NULL) |>
  mutate(learning_style_1 = as.factor(learning_style_1)) |>
  mutate(learning_style_2 = as.factor(learning_style_2)) |>
  # Major
  cbind(split_into_multiple(dataset$major, "major")) |>
  mutate(major = NULL) |>
  # Previous Course Types
  cbind(split_into_multiple(dataset$course_types, "course_types")) |>
  mutate(course_types = NULL) |>
  # Previous Course Subjects
  cbind(split_into_multiple(dataset$course_subjects, "course_subjects")) |>
  mutate(course_subjects = NULL)


```

## Demographics
\label{sec:demographics_res}

First, we look at how well the demographic feature distribution fits the empirical data from which they were sampled. Then, we examine if the demographics are correlated together or if they are independent. Finally, we graph the numerical features (**GPA** and **Student Semester**) and compare them to the uniform distribution from which they were sampled.

### Distribution Fit

Table \ref{tab:demographics_chi_gof} shows how well each of the feature distributions matched the empirical distribution. None of them were significant.

\begin{table}[htbp]
  \centering
  \begin{tabular}{|l|l|}
    \hline
    \textbf{Demographic} & \textbf{P-Value} \\ \hline
    Ethnoracial Group & 1 \\ \hline
    Gender & 1 \\ \hline
    International Student Status & 0.997 \\ \hline
    Socioeconomic Status & 1 \\ \hline
  \end{tabular}
  \caption{Chi Squared Goodness of Fit Test. *p<0.05}
  \label{tab:demographics_chi_gof}
\end{table}

### Demographic Correlations

Table \ref{tab:demographics_chi_indep} shows how well each of the features correlate with each other. None of them were significant. Though **Socioeconomic Status** and **International Student Status** were close to significant at p=0.08951.

\begin{table}[htbp]
  \centering
  \begin{tabular}{|l|l|l|l|}
    \hline
    \multicolumn{1}{|c|}{\multirow{2}{*}{}} &                 \multicolumn{1}{c|}{\multirow{2}{*}{Gender}} & \multicolumn{1}{c|}{International Student} & \multicolumn{1}{c|}{Socioeconomic} \\
    \multicolumn{1}{|c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{Status} & \multicolumn{1}{c|}{Status} \\ \hline
    Ethnoracial Group & 0.8605 & 0.5301 & 0.5707 \\ \hline
    Gender &  & 0.1464 & 0.1799 \\ \hline
    International Student Status &  &  & 0.08951 \\ \hline
  \end{tabular}
  \caption{Chi Squared Test of Independence between Demographics. *p<0.05}
  \label{tab:demographics_chi_indep}
\end{table}

```{r generate_demographic_correlations_graphs, echo=FALSE, results=FALSE}

# Ethnoracial Group vs Gender Graph
g0 <- correlation_graph("Ethnoracial Group", "Gender")
ggsave("ethnoracial_group_v_gender.png", g0)

# Ethnoracial Group vs International Student Status Graph
g1 <- correlation_graph("Ethnoracial Group", "International Student Status")
ggsave("ethnoracial_group_v_international_student_status.png", g1)

# Ethnoracial Group vs Socioeconomic Status Graph
g2 <- correlation_graph("Ethnoracial Group", "Socioeconomic Status")
ggsave("ethnoracial_group_v_socioeconomic_status.png", g2)

# Gender vs International Student Status Graph
g3 <- correlation_graph("International Student Status", "Gender")
ggsave("gender_v_international_student_status.png", g3)

# Gender vs Socioeconomic Status Graph
g4 <- correlation_graph("Gender", "Socioeconomic Status")
ggsave("gender_v_socioeconomic_status.png", g4)

# International Student Status vs Socioeconomic Status Graph
g5 <- correlation_graph("International Student Status", "Socioeconomic Status")
ggsave("international_student_status_v_socioeconomic_status.png", g5)

```

The correlation graph (Figure \ref{fig:demg0}) shows the correlation between ethnoracial group and gender and we see how similar the bars look.

(ref:demg0) Correlation graph between ethnoracial group and gender.

```{r demg0, echo=FALSE, fig.cap="(ref:demg0)"}

knitr::include_graphics("ethnoracial_group_v_gender.png")

```

The correlation graph (Figure \ref{fig:demg1}) shows the correlation between ethnoracial group and international student status and we see how similar the bars look.

(ref:demg1) Correlation graph between ethnoracial group and international student status.

```{r demg1, echo=FALSE, fig.cap="(ref:demg1)"}

knitr::include_graphics("ethnoracial_group_v_international_student_status.png")

```

The correlation graph (Figure \ref{fig:demg0}) shows the correlation between ethnoracial group and socioeconomic status and we see how similar the bars look.

(ref:demg2) Correlation graph between ethnoracial group and socioeconomic status.

```{r demg2, echo=FALSE, fig.cap="(ref:demg2)"}

knitr::include_graphics("ethnoracial_group_v_socioeconomic_status.png")

```

The correlation graph (Figure \ref{fig:demg3}) shows the correlation between gender and international student status and we see how similar the bars look.

(ref:demg3) Correlation graph between gender and international student status.

```{r demg3, echo=FALSE, fig.cap="(ref:demg3)"}

knitr::include_graphics("gender_v_international_student_status.png")

```

The correlation graph (Figure \ref{fig:demg4}) shows the correlation between gender and socioeconomic status and we see how similar the bars look.

(ref:demg4) Correlation graph between gender and socioeconomic status.

```{r demg4, echo=FALSE, fig.cap="(ref:demg4)"}

knitr::include_graphics("gender_v_socioeconomic_status.png")

```

The correlation graph (Figure \ref{fig:demg5}) shows the correlation between international student status and socioeconomic status and we see how similar the bars look.

(ref:demg5) Correlation graph between international student status and socioeconomic status.

```{r demg5, echo=FALSE, fig.cap="(ref:demg5)"}

knitr::include_graphics("international_student_status_v_socioeconomic_status.png")

```

### Numerical Graphs

The graphs were generated using ggplot2 [@wickham2023] and use a theme from hrbrthemes [@rudis2024].

```{r generate_numerical_graphs, echo=FALSE, results=FALSE}

# GPA Graph
gpa_graph <- numerical_col_graph(dataset, gpa, "GPA", 201)
ggsave("gpa.png", gpa_graph)

# Student Semester Graph
student_semester_graph <- numerical_col_graph(dataset, student_semester, "Student Semester", 15)
ggsave("student_semester.png", student_semester_graph)

```

The gpa distribution graph (Figure \ref{fig:gpagraph}) shows the number of students with each GPA and we see how similar the distribution is to the horizontal line which represents a uniform distribution.

(ref:gpagraph) Number of students with different GPAs. The horizontal gray line (y=464.4527) represents the expected values based on a uniform distribution.

```{r gpagraph, echo=FALSE, fig.cap="(ref:gpagraph)"}

knitr::include_graphics("gpa.png")

```

The student semester distribution graph (Figure \ref{fig:studentsemestergraph}) shows the number of students in each semester and we see how similar the distribution is to the horizontal line which represents a uniform distribution.

(ref:studentsemestergraph) Number of students in each semester. The horizontal gray line (y=6666.667) represents the expected values based on a uniform distribution.

```{r studentsemestergraph, echo=FALSE, fig.cap="(ref:studentsemestergraph)"}

knitr::include_graphics("student_semester.png")

```

## Major
\label{sec:major_res}

First, we discuss the popularity of each major. Then, we cover the correlations between **Major(s)** and different demographics. Finally, we graph various distributions of major choice depending on gender identity.

```{r major_demographics, echo=FALSE, results=FALSE}

# Bring in the Majors Dataset which contains real world statistics
majors_data <- fromJSON("majors.json", flatten = TRUE)

# Rename the columns and convert the strings to numerical values and factors
majors_data <- as.data.frame(majors_data) |>
  rename(major = V1) |>
  rename(national_percent_female = V2) |>
  mutate(national_percent_female = as.numeric(national_percent_female) / 100) |>
  # Divide by 100 since the values are between 1 and 100 not 0 and 1
  rename(national_popularity_ranking = V3) |>
  mutate(national_popularity_ranking = as.numeric(national_popularity_ranking)) |>
  rename(division = V4) |>
  mutate(division = as.factor(division)) |>
  rename(top_5_careers = V5) |>
  mutate(top_5_careers = str_remove_all(top_5_careers, "[\'\\[\\]]"))

# Make the Major Demographics Dataset and join it to the Majors Data dataset
majors_demographics <- make_demographic_dataframe(dataset_split, c("major_1", "major_2"), "major", rm.na = TRUE) |>
  group_by(major) |>
  mutate(major = case_when(major == "" ~ NA, .default = major)) |>
  ungroup()

# Create the Major Counts Dataset
major_counts <- majors_demographics |>
  group_by(major) |>
  drop_na() |>
  summarize(major_count = n()) |>
  ungroup()

# Add in the Majors Data to the Majors Counts Dataset
major_counts <- major_counts |>
  left_join(majors_data, by = join_by(major)) |>
  arrange(desc(major_count))

# Add in the observed popularity rankings to the Major Counts Dataset
popularity_ranking <- c(1:length(major_counts$major))

major_counts <- cbind(major_counts, popularity_ranking)

# Join Major Counts to Majors Demographics
majors_demographics <- majors_demographics |>
  left_join(major_counts, by = join_by(major)) |>
  arrange(desc(major_count))

# Plot the Top 10 Majors
top_major_graph <- ggplot(major_counts[1:10,], aes(x = reorder(major, major_count, FUN = function(x) sum(x)),
                                y = major_count,
                                fill = division)) +
  coord_flip() +
  theme_classic() +
  scale_fill_viridis(discrete=TRUE) +
  geom_bar(stat = "identity") +
  labs(x = "Size of Major",
       y = "Most Popular Majors",
       fill = "Major Division")

ggsave("top_major_graph.png", top_major_graph)

# Observed vs Expected Major Popularity
obs_vs_exp_majors <- major_counts |>
  ggplot(aes(x = popularity_ranking,
           y = national_popularity_ranking,
           color = division)) +
  geom_point() +
  theme_classic() +
  scale_color_viridis(discrete=TRUE, guide=FALSE) +
  labs(x = "Observed Major Popularity Ranking",
       y = "Expected Major Popularity Ranking",
       color = "Major Division")

ggsave("obs_vs_exp_majors.png", obs_vs_exp_majors)

# Make the Gender by Major Dataset
gender_by_major <- majors_demographics[,c(2,5)] |>
  group_by(major) |>
  mutate(percent_male = sum(gender == "Male")/n()) |>
  mutate(percent_female = sum(gender == "Female")/n()) |>
  mutate(percent_nonbinary = sum(gender == "Nonbinary")/n()) |>
  mutate(percent_gender_minority = 1-percent_male) |>
  distinct(major, .keep_all = TRUE) |>
  ungroup() |>
  select(-gender) |>
  drop_na() |>
  arrange(major) |>
  # Join the Major Counts dataset
  left_join(major_counts, join_by(major))

# Calculate the Regression line
reg<-lm(national_percent_female ~ percent_female, data = gender_by_major)

# Observed vs Expected Percent Female per Major
obs_vs_exp_gxm <- gender_by_major |>
  mutate(percent_female = round(percent_female, 3)) |>
  
  # Make ggplot
  ggplot(aes(x = percent_female,
           y = national_percent_female,
           color = division)) +
  geom_point() +
  theme_classic() +
  scale_color_viridis(discrete=TRUE, guide=FALSE) +
  labs(x = "Observed Percent Female",
       y = "Expected Percent Female",
       color = "Major Division") +
  # Add line for y=x, the expected regression line
  geom_abline(intercept = 0, slope = 1,
              color="gray",
              linetype="dashed") +
  # Add line for the observed regression line
  geom_abline(intercept = reg$coefficients[1], slope = reg$coefficients[2],
              color="black",
              linetype="dashed")+
  xlim(0,1) +
  ylim(0,1)

ggsave("obs_vs_exp_gxm.png", obs_vs_exp_gxm)

# Observed vs Expected Percent Female per Major, with Major Size
obs_vs_exp_gxm_major_size <- gender_by_major |>
  mutate(percent_female = round(percent_female, 3)) |>
  
  # Reorder majors to having big bubbles on top
  arrange(desc(major_count)) |>
  mutate(major = factor(major, major)) |>
  
  # Create ggplot
  ggplot( aes(x=percent_female,
              y=national_percent_female,
              size = major_count)) +
  geom_point(alpha=0.7) +
  scale_size(range = c(1.4, 19), name="Number of Majors") +
  scale_color_viridis(discrete=TRUE, guide=FALSE) +
  theme_ipsum() +
  labs(x = "Observed Percent Female",
       y = "Expected Percent Female") +
  xlim(0,1) +
  ylim(0,1) +
  theme(legend.position="none",
        axis.title.x = element_text(hjust=0.5), 
        axis.title.y = element_text(hjust=0.5)
        )

ggsave("obs_vs_exp_gxm_major_size.png", obs_vs_exp_gxm_major_size)

# Male Dominated Majors
male_dom <- major_gender_dominated_graph(gender_by_major, percent_male, "Percent Male", "Top Male Dominated Majors")
ggsave("male_dom.png", male_dom)

# Female Dominated Majors
female_dom <- major_gender_dominated_graph(gender_by_major, percent_female, "Percent Female", "Top Female Dominated Majors")
ggsave("female_dom.png", female_dom)

# Gender Minority (Female and Nonbinary) Dominated Majors
gen_min_dom <- major_gender_dominated_graph(gender_by_major, percent_gender_minority, "Percent Gender Minority", "Top Gender Minority Dominated Majors")
ggsave("gen_min_dom.png", gen_min_dom)

```

### Major Popularity

Figure \ref{fig:topmajorgraph} shows the top ten most popular majors in the *Purely Synthetic Educational Dataset*.

(ref:topmajorgraph) Top 10 majors by popularity organized by division.

```{r topmajorgraph, echo=FALSE, fig.cap="(ref:topmajorgraph)"}

knitr::include_graphics("top_major_graph.png")

```

Figure \ref{fig:obsvsexptopmajorsgraph} shows the majors comparing their observed and expected popularity. The Chi Squared Goodness of Fit Test between the expected and observed major popularity gave a p-value of $<2.2e^{-16}$.

(ref:obsvsexptopmajorsgraph) Observed vs expected major popularity organized by division.

```{r obsvsexptopmajorsgraph, echo=FALSE, fig.cap="(ref:obsvsexptopmajorsgraph)"}

knitr::include_graphics("obs_vs_exp_majors.png")

```

### Major Correlations

Table \ref{tab:major_chi_indep} shows the correlations between **Major(s)** and several demographics. Only **Gender** is not independent of the **Major(s)** features.

\begin{table}[htbp]
  \centering
  \begin{tabular}{|l|l|l|}
    \hline
    \textbf{Demographic} & \textbf{Major Correlation} & \textbf{Division Correlation} \\ \hline
    Ethnoracial Group & 0.8966 & 0.1593 \\ \hline
    Gender & $<2.2e^{-16}*$ & $<2.2e^{-16}*$ \\ \hline
    International Student Status & 0.7619 & 0.2205 \\ \hline
    Socioeconomic Status & 0.7008 & 0.3414 \\ \hline
  \end{tabular}
  \caption{Chi Squared Test of Independence between Major and the demographics. *p<0.05}
  \label{tab:major_chi_indep}
\end{table}

### Gender by Major

Figure \ref{fig:expvsobsgxm} shows the expected and observed percent of female identifying students in each major. The observed (dark gray line) and expected (light gray line) linear regression are visually dissimilar. The Chi Squared Goodness of Fit Test between the expected and observed percent of female identifying students gave a p-value of 1.

(ref:expvsobsgxm) Expected vs observed percent female per major, colored by division. The dark gray line (y=1.7855x-0.4378) is the linear regression. The light gray line (y=x) is the expected linear regression, since expected and observed.

```{r expvsobsgxm, echo=FALSE, fig.cap="(ref:expvsobsgxm)"}

knitr::include_graphics("obs_vs_exp_gxm.png")

```

Figure \ref{fig:expvsobsgxm} shows the expected and observed percent of female identifying students in each major. This graph was interactive in the HTML, but that does not work in pdf and so the circles mostly cover each other since the size represents the number of students in each major.

(ref:obsvsexpmajorsizegraph) Observed vs expected percent female by major. Circles are the number of majors. In the HTML this was colored by Major Division and an interactive graph, but that does not work with a pdf output.

```{r obsvsexpmajorsizegraph, echo=FALSE, fig.cap="(ref:obsvsexpmajorsizegraph)"}

knitr::include_graphics("obs_vs_exp_gxm_major_size.png")

```

Figure \ref{fig:maledomgraph} shows the top ten majors that are dominated by male identifying students. All these majors are in the STEM division.

(ref:maledomgraph) Top ten majors with the highest percentage of male students. Colored by division.

```{r maledomgraph, echo=FALSE, fig.cap="(ref:maledomgraph)"}

knitr::include_graphics("male_dom.png")

```

Figure \ref{fig:femaledomgraph} shows the top ten majors that are dominated by female identifying students. The majors are from a variety of divisions.

(ref:femaledomgraph) Top ten majors with the highest percentage of female students. Colored by division.

```{r femaledomgraph, echo=FALSE, fig.cap="(ref:femaledomgraph)"}

knitr::include_graphics("female_dom.png")

```

Figure \ref{fig:genmindomgraph} shows the top ten majors that are dominated by gender minority (female and nonbinary) students. The majors are from a variety of divisions.

(ref:genmindomgraph) Top ten majors with the highest percentage of male students. Colored by division.

```{r genmindomgraph, echo=FALSE, fig.cap="(ref:genmindomgraph)"}

knitr::include_graphics("gen_min_dom.png")

```

No graph was made of nonbinary students, since there are not enough nonbinary students for any major to be majority nonbinary.

## Learning Style
\label{sec:learning_style_res}

Table \ref{tab:learning_style_chi_indep} shows the correlations between **Learning Style(s)** and the demographic features. None of them are significant, so they are all independent.

\begin{table}[htbp]
  \centering
  \begin{tabular}{|l|l|}
    \hline
    \textbf{Demographic} & \textbf{Learning Style Correlation} \\ \hline
    Ethnoracial Group & 0.4939 \\ \hline
    Gender & 0.98 \\ \hline
    International Student Status & 0.6115 \\ \hline
    Socioeconomic Status & 0.6034 \\ \hline
  \end{tabular}
  \caption{Chi Squared Test of Independence between Learning Style and the demographics. *p<0.05}
  \label{tab:learning_style_chi_indep}
\end{table}

## Complex Correlations
\label{sec:complex_correlations_res}

Table \ref{tab:complex_chi_indep} shows the correlations between **Major(s)** and **Previous Course Subjects** as well as **Learning Style(s)** and **Previous Course Types**. The test between **Major(s)** and **Previous Course Subjects** was significant and so they are correlated. However, the test between **Learning Style(s)** and **Previous Course Types** was not significant, so they are independent.

\begin{table}[htbp]
  \centering
  \begin{tabular}{|l|l|}
    \hline
    \textbf{Comparison} & \textbf{Correlation} \\ \hline
    Major vs Previous Course Subjects & $<2.2e^{-16}*$ \\ \hline
    Learning Style vs Previous Course Types & 0.9967 \\ \hline
  \end{tabular}
  \caption{Chi Squared Test of Independence. *p<0.05}
  \label{tab:complex_chi_indep}
\end{table}

# Discussion

In this section we discuss each of the results sections and consider challenges and obstacles. Then we return to the hypothesis and the predictions and finish with the future work section.

1.  Demographics (\ref{sec:demographics_dis})
2.  Major (\ref{sec:major_dis})
3.  Learning Style (\ref{sec:learning_style_dis})
4.  Obstacles and Challenges (\ref{sec:obstacles_challenges})
5.  Hypothesis and Predictions (\ref{sec:hypothesis_predictions})
6.  Future Work (\ref{sec:future_work})

## Demographics
\label{sec:demographics_dis}

The extremely high p-values from the Chi Squared Goodness of Fit Test show that **Ethnoracial Group**, **Gender**, **International Student Status**, and **Socioeconomic Status** all closely math the empirical sampling distribution taken from @nicolas2024. Visually, we see that **GPA** and **Student Semester** match the uniform distribution from which they were sampled.

The insignificant p-values from the Chi Squared Test of Independence show that **Ethnoracial Group**, **Gender**, **International Student Status**, and **Socioeconomic Status** are independent and not correlated with eachother. Notably there is high variation in the p-values with **Ethnoracial Group** and **Gender** having a very high p-value (0.8605), while **International Student Status**, and **Socioeconomic Status** have an almost significant p-value (0.08951).

## Major
\label{sec:major_dis}

The extremely high p-value from the Chi Squared Goodness of Fit Test show that gender distribution among **Major(s)** closely matches the empirical data used in the weighting function. However, the extremely low p-value from the Chi Squared Goodness of Fit Test show that major popularity within **Major(s)** does not match the empirical data used in the weighting function. Thus, the weighting function generated by @nicolas2024 does not properly weight the majors to reflect the empirical data.

The insignificant p-values from the Chi Squared Test of Independence show that **Ethnoracial Group**, **International Student Status**, and **Socioeconomic Status** are independent from and not correlated with **Major(s)**. This was expected since none of these variables are explicitly mapped to **Major(s)**. The very low p-values from the Chi Squared Test of Independence show that **Gender** and **Previous Course Subjects** are correlated with **Major(s)**. This was expected since **Gender** is explicitly mapped to **Major(s)** which is explicitly mapped to **Previous Courses**.

Looking at the top ten majors dominated by different gender identities, we see that all the male dominated majors are STEM while the female or gender minority dominated majors come from a variety of divisions. Looking at Figure \ref{fig:expvsobsgxm} we see that for majors with few female students more female students were observed than expected. At the same time, for majors with more female students less female students were observed than expected. Since some randomization was used in the majors function [@nicolas2024], perhaps this had a normalizing effect which is why only majors at the extremities (very high or very low percentage of female students) were pushed closer to being even balanced between genders (around 50% female).

## Learning Style
\label{sec:learning_style_dis}

The extremely high p-value from the Chi Squared Goodness of Fit Test show that **Learning Style(s)** all closely math the empirical sampling distribution taken from @nicolas2024. The insignificant p-values from the Chi Squared Test of Independence show that **Ethnoracial Group**, **Gender**, **International Student Status**, **Socioeconomic Status**, and **Previous Course Types** are independent and not correlated with **Learning Style(s)**. This was unexpected since **Learning Style(s)** was explicitly mapped to **Previous Course Types**.

## Obstacles and Challenges
\label{sec:obstacles_challenges}

Since the list features in the *Purely Synthetic Educational Dataset* were imported as strings, once they were split and recombined the dataset became very large (\>1,000,000 rows). This limited the tables and graphs that could be made with these features. This is why only the list features **Major(s)** and **Learning Style(s)** which have at most 2 entries were examined closely as they never made the dataset larger than 200,000 rows. Another difficulty was how many of the graphics were made to be interactive and while this worked when knitted to HTML, knitting to pdf prevented interactive graphics. Thus, the graphs shown here are slightly altered versions of the interactive HTML graphics. Finally, the extremely large size of the dataset (100,000 rows and 17 columns) meant that not all features could be examined within the time frame.

## Hypothesis and Predictions
\label{sec:hypothesis_predictions}

Now we return to our predictions and hypothesis (Table \ref{tab:hypothesis_predictions}). All of the features matched their empirical sampling distributions except for major popularity. Thus, the first prediction is mostly supported overall. For the second prediction, only three explicit mappings were measured and two of three showed correlations between the two features. The converse of the second prediction was true with all of the non explicitly mapped features being independent and not correlated with each other.

Thus, the three predictions overall do support the hypothesis that the data generation function from @nicolas2024 works as intended. The nuance comes from the major weighting function, and also the independence of **Learning Style(s)** and **Previous Course Types** which were explicitly mapped.

## Future Work
\label{sec:future_work}

Repeating the same testing on the remaining variables in the dataset can further support the hypothesis and the notion that the dataset is usable for educational research. Additionally, future work should focus on attempting to fix the parts of the generating function that did not work as expected. Once, they are changed, a new dataset could be generated and then the analysis in this work could be repeated on the newly generated dataset. This work only showed that certain features were correlated, but a more advanced statistical analysis is needed to show the strength of the correlation.

Once this work is done, and the dataset has been shown to truly represent the empirical data, then the dataset can be used for educational research. Since the dataset is purely synthetic it is not connected to any real people, and thus poses no privacy risk. Previous educational research [@guan2020; @shao2021] can be redone with the purely synthetic educational dataset to further test the effectiveness of the dataset at replacing empirical data or synthetic data that is based in empirical data.

# References
